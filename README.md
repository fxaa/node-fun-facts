# Node Fun Facts

This is a repository used to keep track of various obscure NodeJS ambiguities. Is `return await` still so bad? What's the performance impact? What about reducers with an async callback?

## Usage

```shell
ts-node src/tests/async/map-and-reduce.ts
ts-node src/tests/async/return-await.ts

╭┄┄┄┄┄┄┄┄┄┬┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┬┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┬┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄╮
┊         ┊ control            ┊ returnAwait        ┊ returnAsync        ┊
├┄┄┄┄┄┄┄┄┄┼┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┼┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┼┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┤
┊ Run 1   ┊ 257.4616650044918  ┊ 276.6424160003662  ┊ 284.06714498996735 ┊
┊ Run 2   ┊ 253.24497801065445 ┊ 280.58302000164986 ┊ 262.78635400533676 ┊
┊ Run 3   ┊ 256.66840198636055 ┊ 274.60032001137733 ┊ 270.8437690138817  ┊
┊ Run 4   ┊ 244.98515698313713 ┊ 263.1487820148468  ┊ 263.139103025198   ┊
┊ Run 5   ┊ 244.18465998768806 ┊ 265.1672680079937  ┊ 269.894495010376   ┊
┊ Run 6   ┊ 244.2688589990139  ┊ 262.2739380002022  ┊ 262.2651409804821  ┊
┊ Run 7   ┊ 242.77786800265312 ┊ 270.6050849854946  ┊ 260.8547820150852  ┊
┊ Run 8   ┊ 241.45281499624252 ┊ 262.0993160009384  ┊ 267.7864969968796  ┊
┊ Run 9   ┊ 243.0806309878826  ┊ 266.1779890060425  ┊ 392.5526169836521  ┊
┊ Run 10  ┊ 247.07472202181816 ┊ 265.9104059934616  ┊ 280.77127200365067 ┊
┊ Average ┊ 247.51997569799423 ┊ 268.72085400223733 ┊ 281.49611750245094 ┊
╰┄┄┄┄┄┄┄┄┄┴┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┴┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┴┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄╯
```

## Current Results

### Async Map vs Reduce

```shell
┌───────────┬───────────────────┬────────────────────┐
│  (index)  │        map        │       reduce       │
├───────────┼───────────────────┼────────────────────┤
│   Run 1   │ 302.3503899872303 │ 2099.945764005184  │
│   Run 2   │ 298.7631230056286 │ 2104.012979000807  │
│   Run 3   │ 294.7641659975052 │ 2094.9517360031605 │
│   Run 4   │ 295.2511090040207 │ 2091.309381991625  │
│   Run 5   │ 294.960588991642  │  2082.45870500803  │
│  Average  │ 297.2178753972054 │ 2094.535713201761  │
│ Advantage │      '0.0%'       │     '-604.7%'      │
└───────────┴───────────────────┴────────────────────┘
```

### Return Await vs Return vs Return Async

```shell
┌───────────┬────────────────────┬────────────────────┬────────────────────┐
│  (index)  │      control       │    returnAwait     │    returnAsync     │
├───────────┼────────────────────┼────────────────────┼────────────────────┤
│   Run 1   │ 31.851099014282227 │  30.3802649974823  │ 31.247225999832153 │
│   Run 2   │ 31.445634990930557 │  34.8086040019989  │ 33.24576699733734  │
│   Run 3   │ 30.194468021392822 │ 30.077297002077103 │ 30.094375997781754 │
│   Run 4   │ 30.141517996788025 │  33.4605770111084  │ 30.23895201086998  │
│   Run 5   │ 33.05533900856972  │ 32.53224501013756  │ 30.193415999412537 │
│   Run 6   │ 32.69640198349953  │ 30.135564982891083 │ 30.156358003616333 │
│   Run 7   │ 30.28117001056671  │ 30.216946989297867 │ 32.68976899981499  │
│   Run 8   │ 33.48571598529816  │ 30.190438002347946 │ 30.08209902048111  │
│   Run 9   │ 34.07532501220703  │ 30.280864000320435 │ 33.700807988643646 │
│  Run 10   │ 30.223793983459473 │ 30.10293897986412  │ 31.34926798939705  │
│  Average  │ 31.745046600699425 │ 31.218574097752573 │ 31.29980390071869  │
│ Advantage │       '0.0%'       │       '1.7%'       │       '1.4%'       │
└───────────┴────────────────────┴────────────────────┴────────────────────┘
┌───────────┬────────────────────┬───────────────────────┬───────────────────────┐
│  (index)  │ control - n = 100  │ returnAwait - n = 100 │ returnAsync - n = 100 │
├───────────┼────────────────────┼───────────────────────┼───────────────────────┤
│   Run 1   │ 2.3905510008335114 │   1.548374980688095   │   1.624358981847763   │
│   Run 2   │ 1.4575679898262024 │  1.4544319808483124   │   1.425735980272293   │
│   Run 3   │ 1.455706000328064  │  1.6992389857769012   │   1.550212025642395   │
│   Run 4   │ 1.651108980178833  │  1.6551830172538757   │  2.1567560136318207   │
│   Run 5   │ 1.8586439788341522 │   3.180900990962982   │   2.147135019302368   │
│   Run 6   │ 1.492937982082367  │   2.213175982236862   │  1.6660549938678741   │
│   Run 7   │ 1.7527030110359192 │   1.401625007390976   │   1.565737009048462   │
│   Run 8   │ 1.4870440065860748 │  3.5332129895687103   │  3.1620409786701202   │
│   Run 9   │ 3.580835998058319  │  2.1557370126247406   │  3.2747550010681152   │
│  Run 10   │ 1.4764170050621033 │  1.6883519887924194   │  1.6025280058383942   │
│  Average  │ 1.8603515952825547 │  2.0530232936143875   │  2.0175314009189607   │
│ Advantage │       '0.0%'       │       '-10.4%'        │        '-8.4%'        │
└───────────┴────────────────────┴───────────────────────┴───────────────────────┘
```
